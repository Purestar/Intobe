//LNB
(function($){
  
  var lnbUI = {
    click : function (target, speed) {
      var _self = this,
          $target = $(target);
      _self.speed = speed || 300;
      
      $target.each(function(){
        if(findChildren($(this))) {
          return;
        }
        $(this).addClass('noDepth');
      });
      
      function findChildren(obj) {
        return obj.find('> ul').length > 0;
      }
      
      $target.on('click','a', function(e){
          e.stopPropagation();
          var $this = $(this),
              $depthTarget = $this.next(),
              $siblings = $this.parent().siblings();
        
        $this.parent('li').find('ul li').removeClass('on');
        // $siblings.removeClass('on');
        // $siblings.find('ul').slideUp(250);
        
        if($depthTarget.css('display') == 'none') {
          _self.activeOn($this);
          $depthTarget.slideDown(_self.speed);
        } else {
          $depthTarget.slideUp(_self.speed);
          _self.activeOff($this);
        }
        
      })
      
    },
    activeOff : function($target) {
      $target.parent().removeClass('on');
    },
    activeOn : function($target) {
      $target.parent().addClass('on');
    }
  };
  
  // Call lnbUI
  $(function(){
    lnbUI.click('.nav li', 300);
    $('.nav-item ul li .nav-link').click(function(){
      $('.nav-item2 .nav-link').removeClass('on');
      $('.nav-item ul li .nav-link').removeClass('on');
      $(this).addClass('on');
    });

    $('.nav-item2 .nav-link').click(function(){
      $('.nav-item2 .nav-link').removeClass('on');
      $(this).addClass('on');
      $('.nav-item').removeClass('on');
      $('.nav-item ul li .nav-link').removeClass('on');
      //$('.nav-item ul').hide();
    });
  });
  }(jQuery));
  function myFunction() {
    var input, filter, ul, li, a, i;
    //input = document.getElementById("mySearch");
    filter = input.value.toUpperCase();
    ul = document.getElementById("lnb");
    li = ul.getElementsByClassName("title");
    for (i = 0; i < li.length; i++) {
      a = li[i].getElementsByTagName("a")[0];
      if (a.innerHTML.toUpperCase().indexOf(filter) > -1) {
        li[i].style.display = "";
      } else {
        li[i].style.display = "none";
      }
    }
}

//Input Check All
function chkAll() {
  var $chkAll = $('#chkAll');
    $chkAll.change(function () {
      var $this = $(this);
      var checked = $this.prop('checked'); // checked 문자열 참조(true, false)
      // console.log(checked);
      $('input[name="check1"]').prop('checked', checked);
  });
  var boxes = $('input[name="check1"]');
    boxes.change(function () {
    var boxLength = boxes.length;
    var checkedLength = $('input[name="check1"]:checked').length;
    var selectAll = (boxLength == checkedLength);
    $chkAll.prop('checked', selectAll);
  });
}
//Input Check All - Popup
function chkAllPop() {
  var $chkAllPop = $('#chkAllPop');
    $chkAllPop.change(function () {
      var $this = $(this);
      var checked = $this.prop('checked'); // checked 문자열 참조(true, false)
      // console.log(checked);
      $('input[name="checkPop"]').prop('checked', checked);
  });
  var boxes = $('input[name="checkPop"]');
    boxes.change(function () {
    var boxLength = boxes.length;
    var checkedLength = $('input[name="checkPop"]:checked').length;
    var selectAll = (boxLength == checkedLength);
    $chkAllPop.prop('checked', selectAll);
  });
}

//Datepicker
function datepicker() {
    $.datepicker.setDefaults({
      dateFormat: 'yy-mm-dd',
      prevText: '이전 달',
      nextText: '다음 달',
      monthNames: ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'],
      monthNamesShort: ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'],
      dayNames: ['일', '월', '화', '수', '목', '금', '토'],
      dayNamesShort: ['일', '월', '화', '수', '목', '금', '토'],
      dayNamesMin: ['일', '월', '화', '수', '목', '금', '토'],
      showMonthAfterYear: true,
      yearSuffix: '년',
      currentText: '오늘',
      showOn: "button",
      buttonImage: "../images/ico_calendar.png", //버튼 이미지 경로
      buttonImageOnly: true, //기본 버튼의 회색 부분을 없애고, 이미지만 보이게 함
      //changeYear : true , changeMonth : true,
      closeText:'취소',
      showButtonPanel: true,
        onClose: function () {
            if ($(window.event.srcElement).hasClass('ui-datepicker-close')) {
                $(this).val('');
            }
        }
    });

    $('.datepicker').datepicker('setDate', 'today'); 

    $.datepicker._gotoToday = function(id) { 
        $(id).datepicker('setDate', new Date()).datepicker('hide').blur(); 
    };

    $('.datepicker').datepicker();
}

//Datetimepicker
function datetimepicker() {
  $('#datetimepicker').datetimepicker({
    datepicker:false,
    format:'H:i'
  });
}

//Accordion
function courseListAccordion(){
  $('.course_list_section:first-child .course_list_content').show();
  $('.course_list_section:first-child>a').addClass('active');
  $(".course_list_section > a").on("click", function() {
    if ($(this).hasClass("active")) {
      $(this).removeClass("active");
      $(this)
        .siblings(".course_list_content")
        .slideUp(200);
      $(".course_list_section > a i")
        .removeClass("fa-minus")
        .addClass("fa-plus");
    } else {
      $(".course_list_section > a i")
        .removeClass("fa-minus")
        .addClass("fa-plus");
      $(this)
        .find("i")
        .removeClass("fa-plus")
        .addClass("fa-minus");
      $(".course_list_section > a").removeClass("active");
      $(this).addClass("active");
      $(".course_list_content").slideUp(200);
      $(this)
        .siblings(".course_list_content")
        .slideDown(200);
    }
  });
}


//Table input 체크시
function iptCheckTrBg(){
  $(".ipt_chk2").click(function(){
  if($(this).is(':checked')){
      $(this).parents('tr').addClass('tr_checked');
    }
    else{
        $(this).parents('tr').removeClass('tr_checked');  
    }
  });
  $("#chkAll").click(function(){
  if($(this).is(':checked')){
      $('tbody tr').addClass('tr_checked')
      $('tbody input[type="checkbox"]').prop('checked',true)
    }
    else{
        $('tbody tr').removeClass('tr_checked')
        $('tbody input[type="checkbox"]').prop('checked',false)    
     }
  });
   
}

//File input style
$(document).ready(function(){
  var fileTarget = $('.filebox .upload-hidden');

  fileTarget.on('change', function(){ // 값이 변경되면
    if(window.FileReader){ // modern browser
      var filename = $(this)[0].files[0].name;
    } 
    else { // old IE
      var filename = $(this).val().split('/').pop().split('\\').pop(); // 파일명만 추출
    }
    // 추출한 파일명 삽입
    $(this).siblings('.upload-name').addClass('on');
    $(this).siblings('.upload-name').text(filename);
    $(this).siblings('.ipt_file').val(filename);

    $(this).siblings('.multi_file_div').children().children('.upload-name').addClass('on');
    $(this).siblings('.multi_file_div').children().children('.upload-name').text(filename);
  });
});

//Tree
$(document).ready(function(){
  var opener = $(".tree_m>button");
  var nested = $(".tree_m>button").parent().parent().find("li");
  var nestedCont = $("li > ul > li").parent();
  var that;

  var tree = {
    init : function () {
      //nestedCont.addClass('hidden'); 
     // $("li>span").addClass("open");
      $("#treeMenu li:first-child").addClass("end");
      $("#treeMenu li:first-child+ul").addClass("end");
      $(".tree_m>button").each( function () {
        $(opener).click(function ( target ) {
         tree.click(this);
        });
       return false;
      })
    },
    click : function ( _tar ) {
     that = _tar;
     $(that).parent().next().addClass('active');
     $(that).parent().prev().toggleClass("open");
     $(that).parent().toggleClass("open");
     if (!$(that).parent().hasClass("open")) {
       $(that).parent().next().removeClass('active');   
     }
    }
  }
  tree.init();

  $("#treeMenu a").click(function(){
    $("#treeMenu a").removeClass('on');
    $(this).not('.tree_m_first a').toggleClass('on');
  });
  $("#treeMenu .tree_m_first").removeClass('on');
});

//검색조건
$(document).ready(function(){
  $('.btn_open').click(function(){
    $(this).toggleClass('active');
    $('.srch_req_box').toggle();

    if( $(".btn_open>span").html() == '검색조건 접기' ) {
      $(".btn_open>span").html('검색조건 펼치기');
    }
    else {
      $(".btn_open>span").html('검색조건 접기');
    }
  })
});


//기수정보매핑
function mappingTab(){
  var mappingTabLi = $('.mapping_tab ul li');
  $('.mapping_tab ul li a').click(function(){
    $('.mapping_tab ul li').removeClass();
    $(this).parent().addClass('active');
  });
  
}

//기수운영 참고사항
$(document).ready(function(){
  $('.note_accordion_top').click(function(){
    $(this).toggleClass('active');
    $('.note_accordion_cont').slideToggle();
  });
});


// table tr toggle
$(document).ready(function(){
  $('.tr_list .bd_title').click(function(){
    $(this).parent('td').parent('.tr_list').next('.tr_view').toggleClass('active');
    return false;
  });
});


function bodyScrollBlock(){
  $('.popup-modal').dialog({
    open: function () {
     $('body').css('overflow', 'hidden');
    },
    close: function () {
      $('body').css('overflow', 'auto');
    },
  });
}



function tblAccordian(){
  $('.tr_list').click(function(){
    $(this).next('.tr_view').toggleClass('active');
    return false;
  });
}

//메인 탭
$(function () {
  var cTab = $('.c_tab>li>.tab');
  var cTabCont = $('.tab_cont');
  cTab.on('click',function(){
    cTab.parent().removeClass('active');
    $(this).parent().addClass('active')
    var idx = cTab.index(this);
    cTabCont.hide();
    cTabCont.eq(idx).show();
    return false;
  });

});


//Modal
// function modalPopup(){
//     $(".btn-pop").click(function(){
//         var modalBox = $(".modal-wrap");
//         modalBox.addClass("open");
//         $('body').css('overflow', 'hidden');
//         return false;
//     });
//     $('.modal-close').click(function(e){
//         $(".modal-wrap").removeClass("open");
//         $('body').css('overflow', 'auto');
//         return false;
//     });
// }


function mainThumbSlide(){
  $('.thumb_div').slick({
    infinite: true,
    slidesToShow: 3,
    slidesToScroll: 1
  });
}

/**
 * 무료 강의 YouTube 영상 팝업 
 */
function freeCourseLayerPopup(youtubeKey, title) {
	
	title = encodeURIComponent(title);
	$.action('layer', {
		url: '/common/playYoutube/popup.do?webUrl=' + youtubeKey + '&title=' + title,
		options: {
			width: 1024,
			height: 850,
		}
	}).run();
}
